<!DOCTYPE HTML> 
<html> 
<head> 
  <title>TCodeSiteFormatter (Delphi)</title> 
  <meta name="generator" content="Help & Manual"> 
  <meta name="keywords" content=""> 
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"> 
  <link type="text/css" href="default.css" rel="stylesheet"> 

  <!-- non-scrolling headers for CHM and browser-based help--> 
  <style type="text/css" media="screen"> 
    a 
    { 
      color: rgb( 60, 60, 120 ); 
      text-decoration: underline 
    }
    a:visited 
    {
      color: rgb( 60, 60, 120 );
      text-decoration: underline 
    }
    a:hover 
    {
      color: rgb( 185, 145, 85 ); 
      text-decoration: underline 
    }
    
    <!-- 
    body 
    {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
    } 
    #idheader 
    {
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
      background: #DCDCDC; 
      border-bottom: 2px solid rgb( 120, 120, 120 );      
    } 
  
    /* Set the padding in the OUTER div for MSIE and CHM to prevent the 
       width bug and the horizontal scrollbar bug from activating. */ 
  
    #idcontent 
    {
      width: 100%; 
      padding: 0px !important; 
      padding: 10px 15px 5px 10px; 
    } 
  
    /* Set the padding in the INNER div for all other browsers. */ 
  
    #innerdiv 
    {
      padding: 10px 5px 5px 10px !important;  
      padding: 0px; 
    } 
  
    /* These styles are for the header, the print link and the navigation links. 
       Change .topichead padding to 5px 5px 0px 5px if you use the Print 
       Topic link.  */
  
    .topichead 
    {
      padding: 5px;
    }
      
    .navlinks 
    {
      font-size: 10pt;
    }
    
    .navlinks a 
    {
      text-decoration: none;
      color: blue;
    }
    
    .navlinks a:visited 
    {
      text-decoration: none;
      color: blue;
    }
    
    .navlinks a:hover 
    {
      text-decoration: underline;
      color: blue;
    }
  
    /* These styles are dynamically assigned with Javascript. 
       Since the media type is "screen", they do not apply for print */ 
  
    html.nonscroll 
    {
      overflow:hidden; 
    } 
  
    body.nonscroll 
    {
      overflow:hidden; 
      height:100%; 
    } 
  
    div.nonscroll 
    {
      overflow:auto; 
    } 
    --> 
  </style> 

  
    <style TYPE="text/css" media="print">
    <!--

      /* Hide navigation links and add space between header and
         text in the printed version. DON'T change this instance for
         adding the Print Topic link, you need the instance further up! */

      #idnav 
      { 
        display:none; 
      }
      
      .topichead 
      { 
        padding: 5px 5px 20px 5px; 
      }
    -->
    </style>
  

  <script type="text/javascript"> 
  <!-- 
  function doResize() 
  {
    var clheight; 
    if (self.innerHeight) // all except Explorer 
    { 
      clheight = self.innerHeight; 
    }
    else if (document.documentElement && document.documentElement.clientHeight) // Explorer 6 Strict Mode
    { 
      clheight = document.documentElement.clientHeight; 
    }
    else if (document.body) // other Explorers 
    { 
      clheight = document.body.clientHeight; 
    }
    document.getElementById('idcontent').style.height = clheight - document.getElementById('idheader').clientHeight +'px';
  } 

  function nsrInit() 
  {
    contentbody = document.getElementById('idcontent'); 
    if (contentbody) 
    {
      contentbody.className = 'nonscroll'; 
      document.getElementsByTagName('body')[0].className = 'nonscroll'; 
      document.getElementsByTagName('html')[0].className = 'nonscroll'; 
      window.onresize = doResize; 
      doResize(); 
    } 
  } 
  --> 
  </script> 

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head> 

<body> 
<div id="idheader"> 
  <table width="100%" border="0" cellspacing="0" cellpadding="0"> 
    <tr valign="middle"> 
      <td align="left" class="topichead"> 
        <p class="p_TopicCategory"><span class="f_TopicCategory">Advanced Techniques</span></p>
<h1 class="p_Heading1"><span class="f_Heading1">Sending Custom Data: TCodeSiteFormatter (Delphi)</span></h1>
 
      </td>
      <td align="right" class="topichead" id="idnav"> 
        <span class="navlinks"> 

          <a href="sendingcustomdata_interfacecsharp.htm"><img src="helpprevious.png" border=0 alt="Previous"></a>&nbsp;
          <a href="codesiteloggingsystem.htm"><img src="helptop.png" border=0 alt="Top"></a>&nbsp;
          <a href="sendingcustomdata_formatterbcb.htm"><img src="helpnext.png" border=0 alt="Next"></a>
        </span> 
      </td> 
    </tr>
  
    <!-- To add a Print Topic link uncomment this section and change the
         padding value of the .topichead style at the top of the template 
         to "padding: 5px 5px 0px 5px;"

    
    <tr id="idnav">
      <td colspan="2" style="padding: 0px 5px 5px 5px">
        <span class="navlinks"><a href="javascript:print()">Print this Topic</a></span>
      </td>
    </tr> 
    

    Uncomment this section to add a Print Topic link -->
  </table>
</div> 

<div id="idcontent"><div id="innerdiv"> 
<p><span style="font-weight: bold;">Note:</span> <span class="f_ExpressEdition">*Not Available in <a href="codesiteeditions.htm" class="topiclink">CodeSite Express</a></span></p>
<p>The following is the complete Delphi Object Pascal source code for the <span style="font-weight: bold;">BaseballPlayer.pas</span> sample unit, which implements a custom formatter for the <span style="font-weight: bold;">TBaseballPlayer</span> data type.</p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">unit</span><span class="f_CodeExample">&nbsp;BaseballPlayer;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">interface</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">uses</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;Windows,&nbsp;Graphics,&nbsp;CodeSiteLogging;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">const</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;csmPlayerSummary&nbsp;=&nbsp;csmUser&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">1</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;csmPlayerDetails&nbsp;=&nbsp;csmUser&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">2</span><span class="f_CodeExample">;</span></p>
<p>&nbsp;</p>
<p>The first thing that we need to do in our custom unit is add the <span style="font-weight: bold;">CodeSiteLogging</span> unit to the uses clause. &nbsp;The second step is to define a new CodeSite message type constant for each formatter class that we are going to create. &nbsp;In this example, two formatter classes will be created. &nbsp;Therefore, we define two new constants.</p>
<p>If you are creating the formatters for your own personal use or for use within your department or organization, then you should define your constants based on the <span style="font-weight: bold;">csmUser</span> constant plus some offset. &nbsp;The valid offset range is 1 to 32,000. &nbsp;If you are creating the formatters for public use outside of your department or organization, then you should define your constants based on the <span style="font-weight: bold;">csmPublic</span> constant plus some offset. &nbsp;Please contact <span style="font-weight: bold;">Raize Software (support@raize.com)</span> to obtain a valid offset that does not conflict with other public formatters.</p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">type</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;TBaseballPlayer&nbsp;=&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">record</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;LastName:&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">string</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;FirstName:&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">string</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;Position:&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">string</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;Salary:&nbsp;Currency;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;Games:&nbsp;Integer;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;AtBats:&nbsp;Integer;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;Hits:&nbsp;Integer;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;ERA:&nbsp;Single;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;AllStar:&nbsp;Boolean;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span><br>
<span class="f_CodeExample">&nbsp;</span></p>
<p>The above record defines the custom data type that we want to send using CodeSite. &nbsp;Please note that the custom data type does not have to reside in the same unit as the custom formatters. &nbsp;It is done so here to simplify the example. &nbsp;Also, any code that requires this data type will also automatically include the necessary formatters.</p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;TPlayerSummaryFormatter&nbsp;=&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">class</span><span class="f_CodeExample">(&nbsp;TCodeSiteFormatter&nbsp;)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">public</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">function</span><span class="f_CodeExample">&nbsp;InspectorType:&nbsp;TCodeSiteInspectorType;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">override</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">procedure</span><span class="f_CodeExample">&nbsp;FormatData(&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">var</span><span class="f_CodeExample">&nbsp;Data&nbsp;);&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">override</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">function</span><span class="f_CodeExample">&nbsp;TypeName:&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">string</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">override</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;TPlayerDetailsFormatter&nbsp;=&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">class</span><span class="f_CodeExample">(&nbsp;TCodeSiteFormatter&nbsp;)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">public</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">function</span><span class="f_CodeExample">&nbsp;InspectorType:&nbsp;TCodeSiteInspectorType;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">override</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">procedure</span><span class="f_CodeExample">&nbsp;FormatData(&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">var</span><span class="f_CodeExample">&nbsp;Data&nbsp;);&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">override</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">function</span><span class="f_CodeExample">&nbsp;TypeName:&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">string</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">override</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p>These are the class declarations for the two custom formatters defined in this unit. &nbsp;The first formatter class will format a <span style="font-weight: bold;">TCSBaseballPlayer</span> record into a text format, while the second formatter will format a <span style="font-weight: bold;">TCSBaseballPlayer</span> record into a name-value grid format. </p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">implementation</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">uses</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;SysUtils;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="color: #000080;">{=====================================}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="color: #000080;">{==&nbsp;TPlayerSummaryFormatter&nbsp;Methods&nbsp;==}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="color: #000080;">{=====================================}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">function</span><span class="f_CodeExample">&nbsp;TPlayerSummaryFormatter.InspectorType:&nbsp;TCodeSiteInspectorType;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">begin</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;Result&nbsp;:=&nbsp;itStockText;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span></p>
<p>&nbsp;</p>
<p>The first step in implementing a custom formatter is to determine which inspector will be used by the CodeSite Viewer to view the formatted data. &nbsp;The inspector type will determine which helper methods are used in the <a href="tcodesiteformatter_formatdata.htm" class="topiclink">FormatData</a> method. &nbsp;For the player summary formatter, the stock string list inspector within the CodeSite Viewer will be used.</p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">procedure</span><span class="f_CodeExample">&nbsp;TPlayerSummaryFormatter.FormatData(&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">var</span><span class="f_CodeExample">&nbsp;Data&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">var</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;Player:&nbsp;TBaseballPlayer;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">begin</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;Player&nbsp;:=&nbsp;TBaseballPlayer(&nbsp;Data&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddLine(&nbsp;Player.FirstName&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'&nbsp;'</span><span class="f_CodeExample">&nbsp;+&nbsp;Player.LastName&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">if</span><span class="f_CodeExample">&nbsp;Player.AllStar&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">then</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;AddLine(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'All-Star&nbsp;'</span><span class="f_CodeExample">&nbsp;+&nbsp;Player.Position&nbsp;)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">else</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;AddLine(&nbsp;Player.Position&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddLine(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">''</span><span class="f_CodeExample">&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddLine(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Salary:&nbsp;'</span><span class="f_CodeExample">&nbsp;+&nbsp;Format(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'%m'</span><span class="f_CodeExample">,&nbsp;[&nbsp;Player.Salary&nbsp;]&nbsp;)&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddLine(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">''</span><span class="f_CodeExample">&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddLine(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Games&nbsp;Played:&nbsp;'</span><span class="f_CodeExample">&nbsp;+&nbsp;IntToStr(&nbsp;Player.Games&nbsp;)&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">if</span><span class="f_CodeExample">&nbsp;Player.Position&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Pitcher'</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">then</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;AddLine(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'ERA:&nbsp;'</span><span class="f_CodeExample">&nbsp;+&nbsp;FormatFloat(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'0.00'</span><span class="f_CodeExample">,&nbsp;Player.ERA&nbsp;)&nbsp;)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">else</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;AddLine(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Batting&nbsp;Avg:&nbsp;'</span><span class="f_CodeExample">&nbsp;+&nbsp;FormatFloat(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'0.000'</span><span class="f_CodeExample">,&nbsp;Player.Hits&nbsp;/&nbsp;Player.AtBats&nbsp;)&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p>The <a href="tcodesiteformatter_formatdata.htm" class="topiclink">FormatData</a> method is where the real work is performed. &nbsp;Note that the parameter to <span style="font-weight: bold;">FormatData</span> is an untyped variable parameter. &nbsp;This means that any data type may be passed to this method. &nbsp;However, because of the registration process that will follow we can safely typecast the passed-in parameter to the type we expect to format.</p>
<p>Fortunately, actually formatting the data is not very complicated because helper methods are defined in the <a href="tcodesiteformatter.htm" class="topiclink">TCodeSiteFormatter</a> base class. Since the <span style="font-weight: bold;">InspectorType</span> method above specified the <span style="font-weight: bold;">itStockText</span> inspector type, the <a href="tcodesiteformatter_addline.htm" class="topiclink">AddLine</a> helper method is used to add lines to the formatted string list.</p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">function</span><span class="f_CodeExample">&nbsp;TPlayerSummaryFormatter.TypeName:&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">string</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">begin</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;Result&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'TBaseballPlayer'</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span></p>
<p>&nbsp;</p>
<p>Overriding the <a href="tcodesiteformatter_typename.htm" class="topiclink">TypeName</a> is optional, but recommended. &nbsp;The message details panel in the CodeSite Viewer will show the TypeName of the data type associated with the message.</p>
<p class="p_CodeExample"><span class="f_CodeExample" style="color: #000080;">{=====================================}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="color: #000080;">{==&nbsp;TPlayerDetailsFormatter&nbsp;Methods&nbsp;==}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="color: #000080;">{=====================================}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">function</span><span class="f_CodeExample">&nbsp;TPlayerDetailsFormatter.InspectorType:&nbsp;TCodeSiteInspectorType;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">begin</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;Result&nbsp;:=&nbsp;itStockProperties;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p>For the player details formatter, the stock name-value grid inspector within the CodeSite Viewer will be used.</p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">procedure</span><span class="f_CodeExample">&nbsp;TPlayerDetailsFormatter.FormatData(&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">var</span><span class="f_CodeExample">&nbsp;Data&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">var</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;Player:&nbsp;TBaseballPlayer;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">begin</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;Player&nbsp;:=&nbsp;TBaseballPlayer(&nbsp;Data&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddNameValuePair(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'LastName'</span><span class="f_CodeExample">,&nbsp;Player.LastName&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddNameValuePair(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'FirstName'</span><span class="f_CodeExample">,&nbsp;Player.FirstName&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddNameValuePair(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Position'</span><span class="f_CodeExample">,&nbsp;Player.Position&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddNameValuePair(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Salary'</span><span class="f_CodeExample">,&nbsp;Format(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'%m'</span><span class="f_CodeExample">,&nbsp;[&nbsp;Player.Salary&nbsp;]&nbsp;)&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddNameValuePair(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Games'</span><span class="f_CodeExample">,&nbsp;Player.Games&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddNameValuePair(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'AtBats'</span><span class="f_CodeExample">,&nbsp;Player.AtBats&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddNameValuePair(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Hits'</span><span class="f_CodeExample">,&nbsp;Player.Hits&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddNameValuePair(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'ERA'</span><span class="f_CodeExample">,&nbsp;Player.ERA&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;AddNameValuePair(&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'AllStar'</span><span class="f_CodeExample">,&nbsp;Player.AllStar&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p>To format you custom data for the name-value grid inspector, use the <a href="tcodesiteformatter_addnamevaluepair.htm" class="topiclink">AddNameValuePair</a> method. &nbsp;The <span style="font-weight: bold;">AddNameValuePair</span> method is overloaded with several variations to minimize the need for converting your data to a string format.</p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">function</span><span class="f_CodeExample">&nbsp;TPlayerDetailsFormatter.TypeName:&nbsp;</span><span class="f_CodeExample" style="font-weight: bold;">string</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">begin</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;Result&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'TBaseballPlayer'</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">initialization</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;CodeSiteManager.RegisterCustomFormatter(&nbsp;csmPlayerummary,TPlayerSummaryFormatter&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;CodeSiteManager.RegisterCustomFormatter(&nbsp;csmPlayerDetails,&nbsp;TPlayerDetailsFormatter&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p>Finally, the new custom formatting classes must be registered with the <a href="codesitemanager.htm" class="topiclink">CodeSiteManager</a> by calling the <a href="codesitemanager_registercustomformatter.htm" class="topiclink">CodeSiteManager.RegisterCustomFormatter </a>method. &nbsp;Note that the corresponding message type is passed along with the class reference of the appropriate formatter. &nbsp;The CodeSiteManager maintains a list of all registered formatters indexed by the message type.  </p>
<p>The above TBaseballPlayer class could then be used as the following method demonstrates.</p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">procedure</span><span class="f_CodeExample">&nbsp;TForm1.Button1Click(Sender:&nbsp;TObject);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">var</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P:&nbsp;TBaseballPlayer;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">begin</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P.LastName&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Schilling'</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P.FirstName&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Curt'</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P.Position&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Pitcher'</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P.Salary&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">3000000.00</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P.Games&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">30</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P.AtBats&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">5</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P.Hits&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">1</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P.ERA&nbsp;:=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">2.32</span><span class="f_CodeExample">;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;P.AllStar&nbsp;:=&nbsp;True;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;CodeSite.SendCustomData(&nbsp;csmPlayerSummary,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Player'</span><span class="f_CodeExample">,&nbsp;P&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;CodeSite.SendCustomData(&nbsp;csmPlayerDetails,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Player'</span><span class="f_CodeExample">,&nbsp;P&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample" style="font-weight: bold;">end</span><span class="f_CodeExample">;</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
 
</div></div> 

<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4 ).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body> 
</html>
