<!DOCTYPE HTML> 
<html> 
<head> 
  <title>Sending Custom Data</title> 
  <meta name="generator" content="Help & Manual"> 
  <meta name="keywords" content="Custom Data,Sending Custom Data"> 
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"> 
  <link type="text/css" href="default.css" rel="stylesheet"> 

  <!-- non-scrolling headers for CHM and browser-based help--> 
  <style type="text/css" media="screen"> 
    a 
    { 
      color: rgb( 60, 60, 120 ); 
      text-decoration: underline 
    }
    a:visited 
    {
      color: rgb( 60, 60, 120 );
      text-decoration: underline 
    }
    a:hover 
    {
      color: rgb( 185, 145, 85 ); 
      text-decoration: underline 
    }
    
    <!-- 
    body 
    {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
    } 
    #idheader 
    {
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
      background: #DCDCDC; 
      border-bottom: 2px solid rgb( 120, 120, 120 );      
    } 
  
    /* Set the padding in the OUTER div for MSIE and CHM to prevent the 
       width bug and the horizontal scrollbar bug from activating. */ 
  
    #idcontent 
    {
      width: 100%; 
      padding: 0px !important; 
      padding: 10px 15px 5px 10px; 
    } 
  
    /* Set the padding in the INNER div for all other browsers. */ 
  
    #innerdiv 
    {
      padding: 10px 5px 5px 10px !important;  
      padding: 0px; 
    } 
  
    /* These styles are for the header, the print link and the navigation links. 
       Change .topichead padding to 5px 5px 0px 5px if you use the Print 
       Topic link.  */
  
    .topichead 
    {
      padding: 5px;
    }
      
    .navlinks 
    {
      font-size: 10pt;
    }
    
    .navlinks a 
    {
      text-decoration: none;
      color: blue;
    }
    
    .navlinks a:visited 
    {
      text-decoration: none;
      color: blue;
    }
    
    .navlinks a:hover 
    {
      text-decoration: underline;
      color: blue;
    }
  
    /* These styles are dynamically assigned with Javascript. 
       Since the media type is "screen", they do not apply for print */ 
  
    html.nonscroll 
    {
      overflow:hidden; 
    } 
  
    body.nonscroll 
    {
      overflow:hidden; 
      height:100%; 
    } 
  
    div.nonscroll 
    {
      overflow:auto; 
    } 
    --> 
  </style> 

  
    <style TYPE="text/css" media="print">
    <!--

      /* Hide navigation links and add space between header and
         text in the printed version. DON'T change this instance for
         adding the Print Topic link, you need the instance further up! */

      #idnav 
      { 
        display:none; 
      }
      
      .topichead 
      { 
        padding: 5px 5px 20px 5px; 
      }
    -->
    </style>
  

  <script type="text/javascript"> 
  <!-- 
  function doResize() 
  {
    var clheight; 
    if (self.innerHeight) // all except Explorer 
    { 
      clheight = self.innerHeight; 
    }
    else if (document.documentElement && document.documentElement.clientHeight) // Explorer 6 Strict Mode
    { 
      clheight = document.documentElement.clientHeight; 
    }
    else if (document.body) // other Explorers 
    { 
      clheight = document.body.clientHeight; 
    }
    document.getElementById('idcontent').style.height = clheight - document.getElementById('idheader').clientHeight +'px';
  } 

  function nsrInit() 
  {
    contentbody = document.getElementById('idcontent'); 
    if (contentbody) 
    {
      contentbody.className = 'nonscroll'; 
      document.getElementsByTagName('body')[0].className = 'nonscroll'; 
      document.getElementsByTagName('html')[0].className = 'nonscroll'; 
      window.onresize = doResize; 
      doResize(); 
    } 
  } 
  --> 
  </script> 

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head> 

<body> 
<div id="idheader"> 
  <table width="100%" border="0" cellspacing="0" cellpadding="0"> 
    <tr valign="middle"> 
      <td align="left" class="topichead"> 
        <p class="p_TopicCategory"><span class="f_TopicCategory">Advanced Techniques</span></p>
<h1 class="p_Heading1"><span class="f_Heading1">Sending Custom Data</span></h1>
 
      </td>
      <td align="right" class="topichead" id="idnav"> 
        <span class="navlinks"> 

          <a href="advancedtechniques.htm"><img src="helpprevious.png" border=0 alt="Previous"></a>&nbsp;
          <a href="codesiteloggingsystem.htm"><img src="helptop.png" border=0 alt="Top"></a>&nbsp;
          <a href="sendingcustomdata_interfacedelphi.htm"><img src="helpnext.png" border=0 alt="Next"></a>
        </span> 
      </td> 
    </tr>
  
    <!-- To add a Print Topic link uncomment this section and change the
         padding value of the .topichead style at the top of the template 
         to "padding: 5px 5px 0px 5px;"

    
    <tr id="idnav">
      <td colspan="2" style="padding: 0px 5px 5px 5px">
        <span class="navlinks"><a href="javascript:print()">Print this Topic</a></span>
      </td>
    </tr> 
    

    Uncomment this section to add a Print Topic link -->
  </table>
</div> 

<div id="idcontent"><div id="innerdiv"> 
<p>Although the methods provided in the <a href="tcodesitelogger.htm" class="topiclink">T|CodeSiteLogger</a> class will handle most of the data types used in your applications, there may be times when you want to send data of a type that the logging class does not support. &nbsp;For example, if you are using Delphi or C++Builder, you may want to send the field values of a record structure, or perhaps the properties of an object whose class type does not include runtime type information (RTTI). &nbsp;Regardless of the framework that you are using, you still may wish to format your data differently than the built-in methods do. For example, a logical interpretation of several different data structures.</p>
<p>It is for these cases that the <span style="font-weight: bold;">T|CodeSiteLogger</span> class defines the <a href="tcodesitelogger_sendcustomdata.htm" class="topiclink">SendCustomData</a> method, which supports sending any data type by relying on a custom formatter to format the data so that it can be viewed by the CodeSite Viewer and stored in a CodeSite Log File. The following sections describe the various ways custom data can be formatted and logged with CodeSite.</p>
<p class="p_SectionHeading"><span class="f_SectionHeading">ICodeSiteCustomData Interface</span></p>
<p>The easiest way to format your custom data for use in CodeSite is to have your custom class implement the <a href="icodesitecustomdata.htm" class="topiclink">ICodeSiteCustomData</a> interface.  <span style="font-weight: bold;">ICodeSiteCustomData</span> defines four methods: <a href="icodesitecustomdata_getformatteddata.htm" class="topiclink">GetFormattedData</a>, <a href="icodesitecustomdata_inspectortype.htm" class="topiclink">InspectorType</a>, <a href="icodesitecustomdata_msgtype.htm" class="topiclink">MsgType</a>, and <a href="icodesitecustomdata_typename.htm" class="topiclink">TypeName</a>.</p>
<p><span style="font-weight: bold;">GetFormattedData</span> is where you will actually format your custom data as desired. Developers using .NET will add their formatted data to a <span style="font-weight: bold;">StringBuilder</span>, while Delphi/C++Builder developers will populate a <span style="font-weight: bold;">TStringList</span>. The <span style="font-weight: bold;">InspectorType</span> method is used to indicate what type of inspector the CodeSite Viewer should use to view your custom format. &nbsp;The choices are <span style="font-weight: bold;">StockText</span>, <span style="font-weight: bold;">StockProperties</span>, <span style="font-weight: bold;">StockTable</span>, <span style="font-weight: bold;">StockHierarchy</span>, and <span style="font-weight: bold;">Custom</span>.</p>
<p>If you are using one of the stock inspectors to display your custom formatted data, then for the <span style="font-weight: bold;">MsgType</span> method, you can simply return zero. &nbsp;If you are specifying a <span style="font-weight: bold;">Custom</span> inspector to be used, then you need to return an integer value that will be used to bind your formatted messages data to the desired custom inspector. &nbsp;If your custom data is for your own personal use or for use within your department or organization, then you should define your integer constant based on the <span style="font-weight: bold;">User</span> constant plus some offset. &nbsp;The valid offset range is 1 to 32,000.  </p>
<p>If you are creating the class and custom format for public use outside of your department or organization, then you should define your constants based on the <span style="font-weight: bold;">Public</span> constant plus some offset. &nbsp;Please contact <span style="font-weight: bold;">Raize Software (support@raize.com)</span> to obtain a valid offset that does not conflict with other public formatters.</p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 10px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><a href="sendingcustomdata_interfacedelphi.htm" class="topiclink">Delphi Example</a></p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 10px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><a href="sendingcustomdata_interfacecsharp.htm" class="topiclink">C# Example</a> </p><p class="p_SectionHeading"><span class="f_SectionHeading">TCodeSiteFormatter Class (Delphi/C++Builder Only)</span></p>
<p>For developers using Delphi, the <a href="tcodesiteformatter.htm" class="topiclink">TCodeSiteFormatter</a> class provides an alternate way of formatting custom data. &nbsp;Specifically, you create a descendant of the <span style="font-weight: bold;">TCodeSiteFormatter</span> class and override the <a href="tcodesiteformatter_formatdata.htm" class="topiclink">FormatData</a> method and optionally the <a href="tcodesiteformatter_inspectortype.htm" class="topiclink">InspectorType</a> and <a href="tcodesiteformatter_typename.htm" class="topiclink">TypeName </a>methods. &nbsp;The <span style="font-weight: bold;">TCodeSiteFormatter</span> descendant is then registered with the <a href="codesitemanager.htm" class="topiclink">CodeSiteManager</a> by calling the <a href="codesitemanager_registercustomformatter.htm" class="topiclink">CodeSiteManager.RegisterCustomFormatter</a> method. &nbsp;In addition to the new formatting class, the <span style="font-weight: bold;">RegisterCustomFormatter</span> method requires a new message type constant that will be used to identify the formatting class from within the <a href="tcodesitelogger_sendcustomdata.htm" class="topiclink">SendCustomData</a> method.</p>
<p>The easiest way to understand this is to see an example. &nbsp;Click on one of the links below to see the source code (in the appropriate language) for a unit that defines a custom record structure along with all the pieces required to send this custom record using the <span style="font-weight: bold;">SendCustomData</span> method.  </p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 10px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><a href="sendingcustomdata_formatterdelphi.htm" class="topiclink">Delphi Example</a> </p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 10px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><a href="sendingcustomdata_formatterbcb.htm" class="topiclink">C++Builder Example</a> </p><p>&nbsp;</p>
 
</div></div> 

<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4 ).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body> 
</html>
