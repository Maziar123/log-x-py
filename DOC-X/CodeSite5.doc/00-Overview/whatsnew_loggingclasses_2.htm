<!DOCTYPE HTML> 
<html> 
<head> 
  <title>Logging Classes</title> 
  <meta name="generator" content="Help & Manual"> 
  <meta name="keywords" content=""> 
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"> 
  <link type="text/css" href="default.css" rel="stylesheet"> 

  <!-- non-scrolling headers for CHM and browser-based help--> 
  <style type="text/css" media="screen"> 
    a 
    { 
      color: rgb( 60, 60, 120 ); 
      text-decoration: underline 
    }
    a:visited 
    {
      color: rgb( 60, 60, 120 );
      text-decoration: underline 
    }
    a:hover 
    {
      color: rgb( 185, 145, 85 ); 
      text-decoration: underline 
    }
    
    <!-- 
    body 
    {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
    } 
    #idheader 
    {
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
      background: #DCDCDC; 
      border-bottom: 2px solid rgb( 120, 120, 120 );      
    } 
  
    /* Set the padding in the OUTER div for MSIE and CHM to prevent the 
       width bug and the horizontal scrollbar bug from activating. */ 
  
    #idcontent 
    {
      width: 100%; 
      padding: 0px !important; 
      padding: 10px 15px 5px 10px; 
    } 
  
    /* Set the padding in the INNER div for all other browsers. */ 
  
    #innerdiv 
    {
      padding: 10px 5px 5px 10px !important;  
      padding: 0px; 
    } 
  
    /* These styles are for the header, the print link and the navigation links. 
       Change .topichead padding to 5px 5px 0px 5px if you use the Print 
       Topic link.  */
  
    .topichead 
    {
      padding: 5px;
    }
      
    .navlinks 
    {
      font-size: 10pt;
    }
    
    .navlinks a 
    {
      text-decoration: none;
      color: blue;
    }
    
    .navlinks a:visited 
    {
      text-decoration: none;
      color: blue;
    }
    
    .navlinks a:hover 
    {
      text-decoration: underline;
      color: blue;
    }
  
    /* These styles are dynamically assigned with Javascript. 
       Since the media type is "screen", they do not apply for print */ 
  
    html.nonscroll 
    {
      overflow:hidden; 
    } 
  
    body.nonscroll 
    {
      overflow:hidden; 
      height:100%; 
    } 
  
    div.nonscroll 
    {
      overflow:auto; 
    } 
    --> 
  </style> 

  
    <style TYPE="text/css" media="print">
    <!--

      /* Hide navigation links and add space between header and
         text in the printed version. DON'T change this instance for
         adding the Print Topic link, you need the instance further up! */

      #idnav 
      { 
        display:none; 
      }
      
      .topichead 
      { 
        padding: 5px 5px 20px 5px; 
      }
    -->
    </style>
  

  <script type="text/javascript"> 
  <!-- 
  function doResize() 
  {
    var clheight; 
    if (self.innerHeight) // all except Explorer 
    { 
      clheight = self.innerHeight; 
    }
    else if (document.documentElement && document.documentElement.clientHeight) // Explorer 6 Strict Mode
    { 
      clheight = document.documentElement.clientHeight; 
    }
    else if (document.body) // other Explorers 
    { 
      clheight = document.body.clientHeight; 
    }
    document.getElementById('idcontent').style.height = clheight - document.getElementById('idheader').clientHeight +'px';
  } 

  function nsrInit() 
  {
    contentbody = document.getElementById('idcontent'); 
    if (contentbody) 
    {
      contentbody.className = 'nonscroll'; 
      document.getElementsByTagName('body')[0].className = 'nonscroll'; 
      document.getElementsByTagName('html')[0].className = 'nonscroll'; 
      window.onresize = doResize; 
      doResize(); 
    } 
  } 
  --> 
  </script> 

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head> 

<body> 
<div id="idheader"> 
  <table width="100%" border="0" cellspacing="0" cellpadding="0"> 
    <tr valign="middle"> 
      <td align="left" class="topichead"> 
        <p class="p_TopicCategory"><span class="f_TopicCategory">What's New</span></p>
<h1 class="p_Heading1"><span class="f_Heading1">Logging Classes</span></h1>
 
      </td>
      <td align="right" class="topichead" id="idnav"> 
        <span class="navlinks"> 

          <a href="whatsnewcs4.htm"><img src="helpprevious.png" border=0 alt="Previous"></a>&nbsp;
          <a href="codesiteloggingsystem.htm"><img src="helptop.png" border=0 alt="Top"></a>&nbsp;
          <a href="whatsnew_viewer_2.htm"><img src="helpnext.png" border=0 alt="Next"></a>
        </span> 
      </td> 
    </tr>
  
    <!-- To add a Print Topic link uncomment this section and change the
         padding value of the .topichead style at the top of the template 
         to "padding: 5px 5px 0px 5px;"

    
    <tr id="idnav">
      <td colspan="2" style="padding: 0px 5px 5px 5px">
        <span class="navlinks"><a href="javascript:print()">Print this Topic</a></span>
      </td>
    </tr> 
    

    Uncomment this section to add a Print Topic link -->
  </table>
</div> 

<div id="idcontent"><div id="innerdiv"> 
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>The primary logging class used to capture, record, and transmit CodeSite logging messages has been changed from <span style="font-weight: bold;">T|CodeSiteObject</span> to <a href="tcodesitelogger.htm" class="topiclink">T|CodeSiteLogger</a>. The old classes are still available for backward compatibility, but for new applications, the new class names should be used. This change does NOT affect the global CodeSite object in Delphi/C++Builder, nor the static class in .NET.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>The <span style="font-weight: bold;">TransportMethod</span> property has been removed from <span style="font-weight: bold;">T|CodeSiteLogger</span>. Configuring the connection to the CodeSite Dispatcher has been replaced with the new methods listed in the next item.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 10px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added several new methods to the <a href="codesitemanager.htm" class="topiclink">CodeSiteManager</a> for configuring the default connection used by <a href="tcodesitelogger.htm" class="topiclink">T|CodeSiteLogger</a> instances when connecting to the CodeSite Dispatcher. The new methods are: </p><p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;ConnectUsingCopyData;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;ConnectUsingTcp(&nbsp;host,&nbsp;port&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;ConnectUsingTcp(&nbsp;host&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;ConnectUsingTcp;</span></p>
<p style="margin: 0px 0px 10px 13px;"><span style="font-size: 10pt; font-family: Arial; color: #000000;">&nbsp;</span><br>
The addition of these methods makes it possible to establish a connection to a dispatcher that is shared by all instances of <span style="font-weight: bold;">T|CodeSiteLogger</span>. It should also be noted that the <a href="codesitemanager_connectusingtcp.htm" class="topiclink">ConnectUsingTcp</a> methods allow a direct connection to be established to a remote CodeSite Dispatcher.</p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 10px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>The <a href="tcodesitelogger.htm" class="topiclink">T|CodeSiteLogger</a> class also defines several methods that can be used to override the default connection used when connecting to the CodeSite Dispatcher. The default connection is established by the CodeSiteManager. The new methods are: </p><p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;ConnectUsingCopyData;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;ConnectUsingTcp(&nbsp;host,&nbsp;port&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;ConnectUsingTcp(&nbsp;host&nbsp;);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;ConnectUsingTcp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;UseCodeSiteManagerConnection;</span><br>
<span class="f_CodeExample">&nbsp;</span></p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 10px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>The packages that contain the CodeSite Logging classes for Delphi/C++Builder development have been renamed in a manner similar to the convention used in the recent release of Raize Components. &nbsp;The primary benefit of this is that the version number of the product and the version number of the RTL have been removed from the names. &nbsp;The result is that when a new version of CodeSite is released, you will no longer be required to modify the source code of your dependent packages.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>CS4 includes the new <span style="font-weight: bold;">CodeSiteDBTools</span> unit in the Delphi logging interface. This unit includes 2 custom formatters and a component to aid in capturing database related information with CodeSite. &nbsp;In particular, the TCSDataSetFormatter is used to capture the field values for all records in a specified TDataSet and package them into a csmCustomTable message. The TCSDataSetRecordFormatter is used to capture the field values for the current record in a specified TDataSet and package them into a csmCustomProperties message. And finally, the <span style="font-weight: bold;">TCodeSiteSqlMonitor</span> component is a descendant of TSqlMonitor and automatically logs dbExpress messages and routes them to a specified <a href="tcodesitelogger.htm" class="topiclink">TCodeSiteLogger</a> instance.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>The <span style="font-weight: bold;">CodeSiteDBTools</span> unit and dependent units are included in the new <span style="font-weight: bold;">CodeSiteDBToolsVcl</span> package so as to isolate the database dependent code from the non-data-aware logging classes.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>In order to simplify the sending of the database related information above, the method by which objects are sent in CodeSite has been enhanced. In particular, it is no longer necessary to use the SendCustomData method when sending data that is to be formatted by a custom formatter. &nbsp;For example, give a TClientDataSet named, cdsCustomers, the entire dataset can be sent to CodeSite using the following statement:</p><p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;CodeSite.Send(&nbsp;csmDataSet,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">'Customers'</span><span class="f_CodeExample">,&nbsp;cdsCustomers&nbsp;);</span><br>
<span class="f_CodeExample">&nbsp;</span></p>
<p style="margin: 0px 0px 19px 13px;">The other primary benefit of this is that it is no longer necessary to create helper functions to send custom formatted data. And this also means that sending custom formatted data using different <span style="font-weight: bold;">TCodeSiteLogger</span> instances is as simple as sending any other type of information.</p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Several overloaded <a href="tcodesitelogger_exitmethodcollapse.htm" class="topiclink">ExitMethodCollapse</a> methods have been added to all logging interfaces. These methods match the various ExitMethod methods that are available except that when the exit method is received by the viewer, the method block is collapsed. Please note that this collapsing is not persistent into log files saved from the viewer. &nbsp;That is, when an <span style="font-weight: bold;">ExitMethodCollapse</span> message is processed by the viewer, it is translated to a normal <a href="tcodesitelogger_exitmethod.htm" class="topiclink">ExitMethod</a> message.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added <a href="tcodesitelogger_sendcontrols.htm" class="topiclink">SendControls</a>, <a href="tcodesitelogger_sendcomponents.htm" class="topiclink">SendComponents</a>, and <a href="tcodesitelogger_sendparents.htm" class="topiclink">SendParents</a> methods to the Delphi logging classes. &nbsp;Added <span style="font-weight: bold;">SendControls</span> and <span style="font-weight: bold;">SendParents</span> methods to the .NET logging classes (.NET does not have the concept of Owner). <span style="font-weight: bold;">SendControls</span> records all other controls (<span style="font-weight: bold;">TControl</span> in Delphi, System.Windows.Forms.Control in .NET) that are contained within the specified control.  <span style="font-weight: bold;">SendComponents</span> records all <span style="font-weight: bold;">TComponent</span> instances owned by the specified component.  <span style="font-weight: bold;">SendParents</span> is the opposite of <span style="font-weight: bold;">SendControls</span> in that it records the parent hierarchy for the specified control.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added a new Custom Hierarchy message type (<span style="font-weight: bold;">csmCustomHierarchy</span> in Delphi, <span style="font-weight: bold;">CodeSiteMsgType.CustomHierarchy</span> in .NET). This message type allows a user to record hierarchical data (such as the Controls hierarchy--above) and send it to CodeSite. The viewer displays the hierarchy details of the message in a tree view in the inspector pane.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>The custom formatting classes have been enhanced to support the new hierarchy capabilities. &nbsp;The <span style="font-weight: bold;">CodeSiteInspectorType</span> enumerations has been extended to include <span style="font-weight: bold;">itStockHierarchy</span>. Recording hierarchical data in an inspector is accomplished by simply prefixing the line representing the node by tab characters. Each tab represents a level deeper in the tree.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added several new methods to logging classes to enable developers to quickly write entries into the NT Event Log (on systems that support the NT Event Log). The new methods are <a href="tcodesitelogger_logevent.htm" class="topiclink">LogEvent</a>, <a href="tcodesitelogger_logwarning.htm" class="topiclink">LogWarning</a>, and <a href="tcodesitelogger_logerror.htm" class="topiclink">LogError</a>. Each method takes a message string to write to the Event Log. Optionally, an application-specific event ID and category number may also be specified. The category in the NT Event Log is numeric based (as a resource string identifier) and does not map to the Category property of CodeSite logging classes. &nbsp;The source name recorded into the Event Log is the Application Name concatenated with the CodeSite object's Category property (if not empty). In addition, CodeSite provides a CSEventLogMessages.dll resource library which allows the Event Viewer to display your event log messages without warnings of missing resource message strings.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added <a href="tcodesitelogger_sendscreenshot.htm" class="topiclink">SendScreenShot</a> method to .NET logging interface.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added support for sending <span style="font-weight: bold;">TWideStrings</span> lists in Delphi logging classes.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added support for <span style="font-weight: bold;">Int64</span> properties when sending objects in Delphi.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Fixed problem where sending objects with empty character properties would result in a Unicode error being reported by the Dispatcher.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Fixed problem where Tcp and Udp properties of <a href="tcodesitedestination.htm" class="topiclink">T|CodeSiteDestination</a> were not getting cleared correctly.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Surfaced <a href="tcodesitelogger_sendmsgdetails.htm" class="topiclink">SendMsgDetails</a> method in CodeSite class in the .NET logging class.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Configuration file support in .NET has been redesigned in CS4 to be easier to maintain and to handle changes made in .NET 2.0.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added new <a href="codesitemanager_encodenonvisiblecharacters.htm" class="topiclink">EncodeNonvisibleCharacters</a> property to the <a href="codesitemanager.htm" class="topiclink">CodeSiteManager</a>. When this property is set to True, any nonvisible characters in the message string are encoded so that they are visible. This is useful when strings contain embedded tabs, carriage returns, newlines, etc.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added a new <a href="tcodesitelogger_sendexception.htm" class="topiclink">SendException</a> method. The new overload accepts a message string along with an exception object.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>Added several overloaded <a href="tcodesitelogger_sendif.htm" class="topiclink">SendIf</a> methods. Each method takes a Boolean expression as its first parameter. The specified CodeSite message is only sent if the specified expression is True. The various SendIf overload wrap most of the overloaded Send methods. Likewise, in the Delphi interface, there is also a <a href="tcodesitelogger_senddatetimeif.htm" class="topiclink">SendDateTimeIf</a> method that wraps SendDateTime.</p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 19px 0px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:9pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span>The <a href="codesitemanager.htm" class="topiclink">CodeSiteManager</a> in .NET now handles removing the &quot;.vshost&quot; suffix that is added to the application name when running an application directly from the Visual Studio IDE.</p><p>&nbsp;</p>
 
</div></div> 

<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4 ).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body> 
</html>
