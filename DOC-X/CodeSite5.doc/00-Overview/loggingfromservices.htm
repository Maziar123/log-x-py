<!DOCTYPE HTML> 
<html> 
<head> 
  <title>Logging From Services</title> 
  <meta name="generator" content="Help & Manual"> 
  <meta name="keywords" content="Services"> 
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"> 
  <link type="text/css" href="default.css" rel="stylesheet"> 

  <!-- non-scrolling headers for CHM and browser-based help--> 
  <style type="text/css" media="screen"> 
    a 
    { 
      color: rgb( 60, 60, 120 ); 
      text-decoration: underline 
    }
    a:visited 
    {
      color: rgb( 60, 60, 120 );
      text-decoration: underline 
    }
    a:hover 
    {
      color: rgb( 185, 145, 85 ); 
      text-decoration: underline 
    }
    
    <!-- 
    body 
    {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
    } 
    #idheader 
    {
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
      background: #DCDCDC; 
      border-bottom: 2px solid rgb( 120, 120, 120 );      
    } 
  
    /* Set the padding in the OUTER div for MSIE and CHM to prevent the 
       width bug and the horizontal scrollbar bug from activating. */ 
  
    #idcontent 
    {
      width: 100%; 
      padding: 0px !important; 
      padding: 10px 15px 5px 10px; 
    } 
  
    /* Set the padding in the INNER div for all other browsers. */ 
  
    #innerdiv 
    {
      padding: 10px 5px 5px 10px !important;  
      padding: 0px; 
    } 
  
    /* These styles are for the header, the print link and the navigation links. 
       Change .topichead padding to 5px 5px 0px 5px if you use the Print 
       Topic link.  */
  
    .topichead 
    {
      padding: 5px;
    }
      
    .navlinks 
    {
      font-size: 10pt;
    }
    
    .navlinks a 
    {
      text-decoration: none;
      color: blue;
    }
    
    .navlinks a:visited 
    {
      text-decoration: none;
      color: blue;
    }
    
    .navlinks a:hover 
    {
      text-decoration: underline;
      color: blue;
    }
  
    /* These styles are dynamically assigned with Javascript. 
       Since the media type is "screen", they do not apply for print */ 
  
    html.nonscroll 
    {
      overflow:hidden; 
    } 
  
    body.nonscroll 
    {
      overflow:hidden; 
      height:100%; 
    } 
  
    div.nonscroll 
    {
      overflow:auto; 
    } 
    --> 
  </style> 

  
    <style TYPE="text/css" media="print">
    <!--

      /* Hide navigation links and add space between header and
         text in the printed version. DON'T change this instance for
         adding the Print Topic link, you need the instance further up! */

      #idnav 
      { 
        display:none; 
      }
      
      .topichead 
      { 
        padding: 5px 5px 20px 5px; 
      }
    -->
    </style>
  

  <script type="text/javascript"> 
  <!-- 
  function doResize() 
  {
    var clheight; 
    if (self.innerHeight) // all except Explorer 
    { 
      clheight = self.innerHeight; 
    }
    else if (document.documentElement && document.documentElement.clientHeight) // Explorer 6 Strict Mode
    { 
      clheight = document.documentElement.clientHeight; 
    }
    else if (document.body) // other Explorers 
    { 
      clheight = document.body.clientHeight; 
    }
    document.getElementById('idcontent').style.height = clheight - document.getElementById('idheader').clientHeight +'px';
  } 

  function nsrInit() 
  {
    contentbody = document.getElementById('idcontent'); 
    if (contentbody) 
    {
      contentbody.className = 'nonscroll'; 
      document.getElementsByTagName('body')[0].className = 'nonscroll'; 
      document.getElementsByTagName('html')[0].className = 'nonscroll'; 
      window.onresize = doResize; 
      doResize(); 
    } 
  } 
  --> 
  </script> 

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head> 

<body> 
<div id="idheader"> 
  <table width="100%" border="0" cellspacing="0" cellpadding="0"> 
    <tr valign="middle"> 
      <td align="left" class="topichead"> 
        <p class="p_TopicCategory"><span class="f_TopicCategory">Advanced Techniques</span></p>
<h1 class="p_Heading1"><span class="f_Heading1">Logging From Services</span></h1>
 
      </td>
      <td align="right" class="topichead" id="idnav"> 
        <span class="navlinks"> 

          <a href="dispatcherconnections.htm"><img src="helpprevious.png" border=0 alt="Previous"></a>&nbsp;
          <a href="codesiteloggingsystem.htm"><img src="helptop.png" border=0 alt="Top"></a>&nbsp;
          <a href="codesiteanddotnet.htm"><img src="helpnext.png" border=0 alt="Next"></a>
        </span> 
      </td> 
    </tr>
  
    <!-- To add a Print Topic link uncomment this section and change the
         padding value of the .topichead style at the top of the template 
         to "padding: 5px 5px 0px 5px;"

    
    <tr id="idnav">
      <td colspan="2" style="padding: 0px 5px 5px 5px">
        <span class="navlinks"><a href="javascript:print()">Print this Topic</a></span>
      </td>
    </tr> 
    

    Uncomment this section to add a Print Topic link -->
  </table>
</div> 

<div id="idcontent"><div id="innerdiv"> 
<p>Service applications run in a separate window station from that of the desktop. However, by default, the CodeSite Dispatcher runs in the desktop window station. As a result, the default message transport mechanism used to transfer CodeSite messages to the <a href="dispatcher.htm" class="topiclink">Dispatcher</a>, the <span style="font-weight: bold;">wm_CopyData</span> window message, is blocked by Windows. Microsoft Windows does not allow window messages to cross window station boundaries.</p>
<p>Fortunately, the TCP transport protocol does not suffer from this same restriction. Therefore, if we wish to send CodeSite messages from a service application to the Dispatcher, we need to connect to the Dispatcher using the <span style="font-weight: bold;">TCP</span> protocol instead of <span style="font-weight: bold;">CopyData</span>. To do this, we simply need to call one of the one of the <a href="codesitemanager_connectusingtcp.htm" class="topiclink">ConnectUsingTcp</a> methods of the <a href="codesitemanager.htm" class="topiclink">CodeSiteManager</a> or an individual <a href="tcodesitelogger.htm" class="topiclink">CodeSiteLogger</a> instance. For example,</p>
<p class="p_CodeExample"><span class="f_CodeExample">CodeSiteManager.ConnectUsingTcp;</span></p>
<p>&nbsp;</p>
<p>After this statement, all <span style="font-weight: bold;">T|CodeSiteLogger</span> instances that do not override their own connection settings, will send messages to the <span style="font-weight: bold;">local</span> Dispatcher using the <span style="font-weight: bold;">TCP</span> protocol. &nbsp;To connect to a Dispatcher running on a different machine, you would use one of the overloaded versions of the <span style="font-weight: bold;">ConnectUsingTcp</span> method.</p>
<p>But what if you need to capture logging information from a service application when the desktop is not even available? Such as during system startup, or when no user is currently logged in. There are two options for handling this case. &nbsp;First, you can connect to the <span style="font-weight: bold;">local</span> Dispatcher using TCP, but run the Dispatcher itself as a service. &nbsp;Please read the <a href="dispatcher_service.htm" class="topiclink">CodeSite Dispatcher: Running as a Service</a> topic for details. The second option is to simply connect to a <span style="font-weight: bold;">remote</span> Dispatcher running on a separate machine and run the Dispatcher as a normal application.</p>
<p class="p_SectionHeading"><span class="f_SectionHeading">Troubleshooting Checklist</span></p>
<p>If your CodeSite messages do not appearing , use the following check list to help locate the problem:</p>
<p style="text-align: left; padding: 0px 0px 0px 24px; margin: 0px 0px 10px 0px;"><span style="font-size:9pt; font-family: 'Verdana';color:#000000;display:inline-block;width:24px;margin-left:-24px">1.</span>Make sure the CodeSite Dispatcher is running. When connecting using TCP, the CodeSite Dispatcher will <span style="font-weight: bold;">NOT</span> be automatically started.</p><p style="text-align: left; padding: 0px 0px 0px 24px; margin: 0px 0px 10px 0px;"><span style="font-size:9pt; font-family: 'Verdana';color:#000000;display:inline-block;width:24px;margin-left:-24px">2.</span>If connecting to a remote Dispatcher, make sure you are able to ping the other computer using both the IP address and HostName of the remote computer.</p><p style="text-align: left; padding: 0px 0px 0px 24px; margin: 0px 0px 10px 0px;"><span style="font-size:9pt; font-family: 'Verdana';color:#000000;display:inline-block;width:24px;margin-left:-24px">3.</span>If you are using a firewall, make sure the ports you are using are open. &nbsp;The default port for TCP is 3434 and the default port for UDP is 3435.</p><p style="text-align: left; padding: 0px 0px 0px 24px; margin: 0px 0px 10px 0px;"><span style="font-size:9pt; font-family: 'Verdana';color:#000000;display:inline-block;width:24px;margin-left:-24px">4.</span>If the ports are blocked, ask your network administrator if they can be opened or request a valid port number to use. &nbsp;The port numbers can be changed in the CodeSite Dispatcher Settings dialog.<br>
&nbsp;</p><p class="p_NotesHeader" style="border-bottom: none;"><span class="f_NotesHeader">IMPORTANT</span></p>
<p class="p_Notes" style="border-top: none;"><span class="f_Notes">Please note that if you change the port numbers, then you must alter the ConnectUsingTcp method to specify the new port number. </span></p>
<p style="text-align: left; padding: 0px 0px 0px 24px; margin: 0px 0px 10px 0px;"><span style="font-size:9pt; font-family: 'Verdana';color:#000000;display:inline-block;width:24px;margin-left:-24px">5.</span>If you are trying to send messages to the CodeSite Live Viewer running on the remote computer, make sure the Live Viewer is available on the remote computer and not just the Dispatcher.</p><p style="text-align: left; padding: 0px 0px 0px 24px; margin: 0px 0px 10px 0px;"><span style="font-size:9pt; font-family: 'Verdana';color:#000000;display:inline-block;width:24px;margin-left:-24px">6.</span>Check the connected <a href="dispatcher_commands.htm" class="topiclink">Dispatcher's Log</a> for any error or warning messages.  </p><p>&nbsp;</p>
<p style="text-indent: -48px; margin: 0px 0px 19px 48px;">&nbsp;</p>
 
</div></div> 

<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4 ).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body> 
</html>
